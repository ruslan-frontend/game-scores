# üë• –ì—Ä—É–ø–ø–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ç–µ–ø–µ—Ä—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç **–≥—Ä—É–ø–ø–æ–≤—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É** - –≤—Å–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏ –æ–¥–Ω–æ–π Telegram –≥—Ä—É–ø–ø—ã –≤–∏–¥—è—Ç –æ–±—â–∏–µ –¥–∞–Ω–Ω—ã–µ –ø–æ –∏–≥—Ä–∞–º!

## üéØ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### üîê –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- **–í –ø—Ä–∏–≤–∞—Ç–Ω–æ–º —á–∞—Ç–µ**: –∫–∞–∂–¥—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ
- **–í –≥—Ä—É–ø–ø–µ/—Å—É–ø–µ—Ä–≥—Ä—É–ø–ø–µ**: –≤—Å–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏ –≥—Ä—É–ø–ø—ã –≤–∏–¥—è—Ç –æ–±—â—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É

### üèóÔ∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

#### 1. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
```typescript
// –õ–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –≤ src/app/telegram.ts
const contextId = chat && ['group', 'supergroup'].includes(chat.type) 
  ? chat.id.toString()        // ID –≥—Ä—É–ø–ø—ã 
  : user?.id.toString()       // ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```

#### 2. –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- **–£—á–∞—Å—Ç–Ω–∏–∫–∏**: –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ `context_id` (–≥—Ä—É–ø–ø–∞ –∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)
- **–ò–≥—Ä—ã**: –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ `context_id` 
- **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞**: —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –≤ —Ä–∞–º–∫–∞—Ö –æ–¥–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

#### 3. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
–î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `context_id` –∫ —Ç–∞–±–ª–∏—Ü–∞–º:
- `participants.context_id`
- `games.context_id` 
- `game_participants.context_id`

## üìã –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö

### –®–∞–≥ 1: –í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é
–í Supabase SQL Editor –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –∏–∑ `group-support-migration.sql`:

```sql
-- –î–æ–±–∞–≤–ª—è–µ—Ç –ø–æ–ª–µ context_id –∏ –º–∏–≥—Ä–∏—Ä—É–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ
ALTER TABLE participants ADD COLUMN IF NOT EXISTS context_id TEXT;
ALTER TABLE games ADD COLUMN IF NOT EXISTS context_id TEXT;
-- ... (–ø–æ–ª–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –≤ —Ñ–∞–π–ª–µ)
```

### –®–∞–≥ 2: –û–±–Ω–æ–≤–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ
–°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞—Ç `context_id` —Ä–∞–≤–Ω—ã–π `telegram_id` –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏.

## üéÆ –°—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –õ–∏—á–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- –û—Ç–∫—Ä—ã–≤–∞–µ—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ **–ø—Ä–∏–≤–∞—Ç–Ω–æ–º —á–∞—Ç–µ** —Å –±–æ—Ç–æ–º
- –í–∏–¥–∏—Ç–µ —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –∏–≥—Ä—ã –∏ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
- `contextId = "123456789"` (–≤–∞—à Telegram ID)

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ì—Ä—É–ø–ø–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞  
- –î–æ–±–∞–≤–ª—è–µ—Ç–µ –±–æ—Ç–∞ –≤ **–≥—Ä—É–ø–ø—É –¥—Ä—É–∑–µ–π**
- –ö–∞–∂–¥—ã–π —É—á–∞—Å—Ç–Ω–∏–∫ –≥—Ä—É–ø–ø—ã –≤–∏–¥–∏—Ç –æ–±—â—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
- `contextId = "-987654321"` (ID –≥—Ä—É–ø–ø—ã)

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –ù–µ—Å–∫–æ–ª—å–∫–æ –≥—Ä—É–ø–ø
- –£—á–∞—Å—Ç–≤—É–µ—Ç–µ –≤ **–Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≥—Ä—É–ø–ø–∞—Ö** —Å –±–æ—Ç–æ–º
- –í –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø–µ —Å–≤–æ—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- `contextId` —É–Ω–∏–∫–∞–ª–µ–Ω –¥–ª—è –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø—ã

## ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

üéØ **–î–ª—è —Å–µ–º—å–∏**: –æ–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–µ–º–µ–π–Ω—ã—Ö –∏–≥—Ä  
üéØ **–î–ª—è –¥—Ä—É–∑–µ–π**: —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏–µ –º–µ–∂–¥—É –¥—Ä—É–∑—å—è–º–∏  
üéØ **–î–ª—è –∫–æ–º–∞–Ω–¥**: –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞  
üéØ **–ü—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å**: –ª–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ—Å—Ç–∞—é—Ç—Å—è –ø—Ä–∏–≤–∞—Ç–Ω—ã–º–∏  

## üîß –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
```typescript
import { AuthService } from './shared/lib/auth';

const context = AuthService.getCurrentContext();
console.log(context.contextType); // 'group' | 'private'
console.log(context.contextId);   // ID –≥—Ä—É–ø–ø—ã –∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```

### –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
–í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ñ–∏–ª—å—Ç—Ä—É—é—Ç—Å—è –ø–æ `context_id`:
```typescript
// –£—á–∞—Å—Ç–Ω–∏–∫–∏ —Ç–µ–∫—É—â–µ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
const participants = await ParticipantAdapter.getAll();

// –ò–≥—Ä—ã —Ç–µ–∫—É—â–µ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞  
const games = await GameAdapter.getAll();
```

## üöÄ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

1. **–í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é** –≤ Supabase
2. **–ó–∞–¥–µ–ø–ª–æ–π—Ç–µ** –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
3. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ** –≤ –ø—Ä–∏–≤–∞—Ç–Ω–æ–º —á–∞—Ç–µ –∏ –≥—Ä—É–ø–ø–µ
4. **–ì–æ—Ç–æ–≤–æ!** –ì—Ä—É–ø–ø—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞—Ç –æ–±—â—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É

---

üéâ **–í–∞—à–∏ –∏–≥—Ä—ã, –≤–∞—à–∞ –≥—Ä—É–ø–ø–∞, –≤–∞—à–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞!**